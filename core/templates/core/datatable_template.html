{% extends "core/base.html" %}
{% load i18n static %}

{% block title %}{% trans "قائمة البيانات" %}{% endblock %}

{% block extra_head %}
  <!-- DataTables 2025 (Bootstrap 5 + Buttons + Responsive) -->
  <link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/dataTables.bootstrap5.min.css">
  <link rel="stylesheet" href="https://cdn.datatables.net/buttons/2.4.2/css/buttons.bootstrap5.min.css">
  <link rel="stylesheet" href="https://cdn.datatables.net/responsive/2.5.0/css/responsive.bootstrap5.min.css">
  <style>
    /* مظهر حديث متوافق RTL/LTR */
    table.dataTable tbody tr:hover { background-color: rgba(0,0,0,.02); }
    .dt-toolbar{ display:flex; gap:.5rem; flex-wrap:wrap; }
    .dt-buttons .btn{ border-radius:.6rem; }
    .dataTables_length select{ min-width:80px; }
    thead th{ white-space:nowrap; }
  </style>
{% endblock %}

{% block content %}
<div class="odoo-choose-bg py-4">
  <div class="odoo-container">
    <h2 class="fw-bold mb-3">{% trans "قائمة العناصر" %}</h2>

    <div class="card shadow-sm">
      <div class="card-body">
        <div class="dt-toolbar mb-3">
          <div id="dt-buttons-wrap"></div>
        </div>

        <table id="datatable" class="table table-striped table-bordered nowrap" style="width:100%">
          <thead>
            <tr>
              <th>{% trans "الرقم" %}</th>
              <th>{% trans "الاسم" %}</th>
              <th>{% trans "النوع" %}</th>
              <th>{% trans "الحالة" %}</th>
            </tr>
          </thead>
          <tbody>
            {% for item in items %}
            <tr>
              <td>{{ item.id }}</td>
              <td>{{ item.name }}</td>
              <td>{{ item.category }}</td>
              <td>{{ item.status }}</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>

      </div>
    </div>
  </div>
</div>
{% endblock %}

{% block extra_js %}
  <!-- jQuery + DataTables + Plugins -->
  <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
  <script src="https://cdn.datatables.net/1.13.6/js/dataTables.bootstrap5.min.js"></script>
  <script src="https://cdn.datatables.net/responsive/2.5.0/js/dataTables.responsive.min.js"></script>
  <script src="https://cdn.datatables.net/responsive/2.5.0/js/responsive.bootstrap5.min.js"></script>
  <script src="https://cdn.datatables.net/buttons/2.4.2/js/dataTables.buttons.min.js"></script>
  <script src="https://cdn.datatables.net/buttons/2.4.2/js/buttons.bootstrap5.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/pdfmake.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/vfs_fonts.js"></script>
  <script src="https://cdn.datatables.net/buttons/2.4.2/js/buttons.html5.min.js"></script>
  <script src="https://cdn.datatables.net/buttons/2.4.2/js/buttons.print.min.js"></script>
  <script src="https://cdn.datatables.net/buttons/2.4.2/js/buttons.colVis.min.js"></script>

  <script>
    (function(){
      const lang = document.documentElement.lang || 'ar';
      const i18nUrl = lang.startsWith('ar')
        ? 'https://cdn.datatables.net/plug-ins/1.13.6/i18n/ar.json'
        : 'https://cdn.datatables.net/plug-ins/1.13.6/i18n/en-GB.json';

      const dt = new DataTable('#datatable', {
        responsive: true,
        stateSave: true,
        lengthMenu: [[10,25,50,100,-1],[10,25,50,100,'All']],
        pageLength: 25,
        order: [[0,'desc']],
        language: { url: i18nUrl },
        dom: "<'row align-items-center mb-2'<'col-sm-12 col-md-6'lf><'col-sm-12 col-md-6 text-end'B>>" +
             "rt<'row mt-2'<'col-sm-12 col-md-5'i><'col-sm-12 col-md-7'p>>",
        buttons: [
          { extend:'excelHtml5', text:'Excel', className:'btn btn-outline-success btn-sm' },
          { extend:'pdfHtml5',   text:'PDF',   className:'btn btn-outline-danger btn-sm'  },
          { extend:'print',      text:'Print', className:'btn btn-outline-secondary btn-sm' },
          { extend:'colvis',     text:'Columns', className:'btn btn-outline-primary btn-sm' }
        ]
      });

      // نقل الأزرار لمنطقة مخصصة
      dt.buttons().container().appendTo('#dt-buttons-wrap');
    })();
  </script>
{% endblock %}
