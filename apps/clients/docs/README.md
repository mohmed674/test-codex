# 📁 وحدة العملاء (Clients App)

## 🧩 تعريف الوحدة
تُستخدم وحدة "العملاء" لإدارة معلومات العملاء وتاريخ عمليات الشراء وتحليل نشاطهم داخل النظام. تشمل الوظائف إدارة البيانات، الذكاء الاصطناعي، طباعة التقارير، وربط البيانات بمبيعات العملاء.

---

## 🔧 الوظائف الأساسية

| الوظيفة | الوصف |
|--------|-------|
| 📋 عرض العملاء | قائمة بكل العملاء المسجلين في النظام |
| ➕ إضافة عميل | نموذج إدخال بيانات عميل جديد |
| ✏️ تعديل عميل | تعديل بيانات عميل موجود |
| 🗑️ حذف عميل | حذف سجل عميل نهائيًا |
| 🤖 تحليل ذكاء اصطناعي | توصيات آلية بناءً على نشاط العميل |
| 🖨️ طباعة بيانات عميل | إنشاء تقرير PDF فردي للعميل |
| 📊 لوحة تحكم التحليل | إحصائيات عن العملاء النشطين وغير النشطين |

---

## 📦 نموذج البيانات

### `Client` Model:

| الحقل | النوع | الوصف |
|-------|------|-------|
| `name` | CharField | اسم العميل |
| `phone` | CharField | رقم الهاتف (فريد) |
| `email` | EmailField | البريد الإلكتروني (اختياري) |
| `address` | CharField | العنوان |
| `notes` | TextField | ملاحظات داخلية |
| `points` | PositiveIntegerField | نقاط الولاء |
| `total_purchases` | Decimal | إجمالي قيمة الشراء |
| `last_purchase_date` | DateField | تاريخ آخر عملية شراء |
| `is_active` | Boolean | حالة النشاط |
| `created_at` | DateTime | تاريخ الإنشاء |

---

## 🤖 الذكاء الاصطناعي والتحليلات

- تعتمد الوحدة على دالة `get_ai_insight_for_client(client)` لتقديم توصيات:
  - خصم VIP.
  - اقتراح حملات نقاط.
  - ملاحظات على العملاء غير النشطين.

---

## 🔗 التكاملات

| النظام المرتبط | الوظيفة |
|----------------|---------|
| `sales.SaleInvoice` | تحديث النقاط والمشتريات تلقائيًا بعد كل فاتورة |
| `internal_monitoring.RiskIncident` | إنشاء بلاغ مخاطرة تلقائي عند بيع بقيمة مرتفعة |

---

## 🧾 التقارير والطباعة

| نوع التقرير | التقنية | القالب المستخدم |
|-------------|---------|-----------------|
| PDF فردي للعميل | `WeasyPrint` | `client_pdf.html` |
| AI تحليل | ذكاء اصطناعي داخلي | `ai_insights.html` |
| Dashboard | تقرير تفاعلي | `client_analysis_dashboard.html` |

---

## ⚙️ إشعارات نظامية (Messages)

- بعد كل إضافة/تعديل/حذف عميل يتم عرض تنبيه تفاعلي من `django.contrib.messages`.

---

## 🛠️ ملفات الوحدة

| الملف | الوصف |
|-------|-------|
| `models.py` | يحتوي على نموذج `Client` |
| `admin.py` | تخصيص لوحة الإدارة |
| `forms.py` | نموذج الإدخال |
| `views.py` | جميع الوظائف التشغيلية |
| `signals.py` | معالجة ما بعد الحفظ |
| `ai.py` | منطق التحليل الذكي |
| `urls.py` | توجيه الروابط |
| `templates/` | ملفات HTML المرتبطة |
| `docs/README.md` | 🔹 هذا الملف |

---

## ✅ الحالة الحالية
- [x] جميع الميزات مكتملة
- [x] التكاملات فعالة
- [x] الذكاء الاصطناعي مدمج
- [x] التوثيق جاهز

---

## 🧠 اقتراح مستقبلي (تم تنفيذه فعلًا ✅)
- كان من المخطط نقل التصدير إلى ملفات مستقلة، وقد تم التنفيذ سابقًا في `attendance`.

---

## 🗓️ تاريخ التوثيق: `{{ اليوم }}`
