{% load static %}
<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>طباعة فاتورة مبيعات</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.rtl.min.css" rel="stylesheet">
    <style>
        body {
            padding: 20px;
            background: #fff;
        }
        .invoice-box {
            border: 1px solid #ccc;
            padding: 20px;
        }
        .no-print {
            margin-bottom: 20px;
        }
        @media print {
            .no-print {
                display: none;
            }
        }
    </style>
</head>
<body>

<div class="no-print">
    <a href="#" onclick="window.print()" class="btn btn-success">🖨️ طباعة عادية</a>
    <a href="{% url 'sales:invoice_pdf' invoice.id %}" class="btn btn-primary">📄 طباعة PDF</a>
</div>

<div class="invoice-box">
    <h2 class="text-center mb-4">🧾 فاتورة مبيعات</h2>

    <div class="mb-3">
        <strong>رقم الفاتورة:</strong> {{ invoice.invoice_number }}<br>
        <strong>التاريخ:</strong> {{ invoice.date }}
    </div>

    <div class="mb-3">
        <strong>اسم العميل:</strong> {{ invoice.client.name }}<br>
        <strong>رقم الهاتف:</strong> {{ invoice.client.phone }}<br>
        <strong>العنوان:</strong> {{ invoice.client.address }}
    </div>

    <table class="table table-bordered text-center">
        <thead class="table-light">
            <tr>
                <th>المنتج</th>
                <th>الكمية</th>
                <th>سعر الوحدة</th>
                <th>الخصم</th>
                <th>الإجمالي</th>
            </tr>
        </thead>
        <tbody>
            {% for item in invoice.items.all %}
            <tr>
                <td>{{ item.product.name }}</td>
                <td>{{ item.quantity }}</td>
                <td>{{ item.unit_price }}</td>
                <td>{{ item.discount }}</td>
                <td>{{ item.total|floatformat:2 }}</td>
            </tr>
            {% endfor %}
        </tbody>
        <tfoot>
            <tr>
                <th colspan="4" class="text-end">الإجمالي الكلي:</th>
                <th>{{ invoice.total_amount|floatformat:2 }}</th>
            </tr>
        </tfoot>
    </table>

    <div class="mt-4">
        <strong>طريقة الدفع:</strong> 
        {% if invoice.payment_method == 'cash' %} نقدي
        {% elif invoice.payment_method == 'vodafone_cash' %} فودافون كاش
        {% elif invoice.payment_method == 'instapay' %} إنستاباي
        {% elif invoice.payment_method == 'bank' %} تحويل بنكي
        {% elif invoice.payment_method == 'cheque' %} شيك
        {% endif %}
    </div>

    <div class="mt-4">
        <strong>الموظف المسؤول:</strong> {{ invoice.created_by.name }}
    </div>
</div>

</body>
</html>
