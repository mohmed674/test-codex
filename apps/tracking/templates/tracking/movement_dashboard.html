{% extends "base.html" %}
{% load static %}

{% block content %}
<div class="container mt-4">
  <div class="card shadow p-4 rounded-4">

    <div class="d-flex justify-content-between align-items-center mb-3">
      <h4 class="mb-0">ğŸšš Ù„ÙˆØ­Ø© ØªØ­Ø±ÙƒØ§Øª Ø§Ù„Ø´Ø­Ù†Ø§Øª</h4>
      <a href="{% url 'tracking:movement_create' %}" class="btn btn-success">â• ØªØ³Ø¬ÙŠÙ„ Ø­Ø±ÙƒØ© Ø¬Ø¯ÙŠØ¯Ø©</a>
    </div>

    <!-- ğŸ” ÙÙ„ØªØ±Ø© -->
    <form method="get" class="row g-2 mb-4">
      <div class="col-md-4">
        <input type="text" name="tracking_code" class="form-control" placeholder="ÙƒÙˆØ¯ Ø§Ù„ØªØªØ¨Ø¹" value="{{ filters.tracking_code }}">
      </div>
      <div class="col-md-4">
        <select name="status" class="form-select">
          <option value="">ÙƒÙ„ Ø§Ù„Ø­Ø§Ù„Ø§Øª</option>
          <option value="pending" {% if filters.status == 'pending' %}selected{% endif %}>Ù‚ÙŠØ¯ Ø§Ù„Ø´Ø­Ù†</option>
          <option value="in_transit" {% if filters.status == 'in_transit' %}selected{% endif %}>Ù‚ÙŠØ¯ Ø§Ù„Ù†Ù‚Ù„</option>
          <option value="delivered" {% if filters.status == 'delivered' %}selected{% endif %}>ØªÙ… Ø§Ù„ØªØ³Ù„ÙŠÙ…</option>
          <option value="cancelled" {% if filters.status == 'cancelled' %}selected{% endif %}>Ø£ÙÙ„ØºÙŠØª</option>
        </select>
      </div>
      <div class="col-md-2">
        <input type="date" name="from" class="form-control" value="{{ filters.from }}">
      </div>
      <div class="col-md-2">
        <input type="date" name="to" class="form-control" value="{{ filters.to }}">
      </div>
      <div class="col-md-3 mt-2">
        <button type="submit" class="btn btn-dark w-100">ğŸ” Ø¨Ø­Ø«</button>
      </div>
      <div class="col-md-3 mt-2">
        <a href="{% url 'tracking:tracking_movement_dashboard' %}" class="btn btn-secondary w-100">ğŸ” Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ†</a>
      </div>
    </form>

    <!-- ğŸ“‹ Ø¬Ø¯ÙˆÙ„ -->
    <div class="table-responsive">
      <table class="table table-bordered table-striped text-center align-middle">
        <thead class="table-dark">
          <tr>
            <th>ÙƒÙˆØ¯ Ø§Ù„ØªØªØ¨Ø¹</th>
            <th>Ø§Ù„Ù…Ù†ØªØ¬</th>
            <th>Ø§Ù„Ù…ÙˆÙ‚Ø¹</th>
            <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
            <th>Ø§Ù„ÙˆÙ‚Øª</th>
          </tr>
        </thead>
        <tbody>
          {% for move in movements %}
          <tr>
            <td>{{ move.tracking.tracking_code }}</td>
            <td>{{ move.tracking.product_name }}</td>
            <td>{{ move.location }}</td>
            <td>
              {% if move.status == 'pending' %}
                <span class="badge bg-warning text-dark">Ù‚ÙŠØ¯ Ø§Ù„Ø´Ø­Ù†</span>
              {% elif move.status == 'in_transit' %}
                <span class="badge bg-info text-dark">Ù‚ÙŠØ¯ Ø§Ù„Ù†Ù‚Ù„</span>
              {% elif move.status == 'delivered' %}
                <span class="badge bg-success">ØªÙ… Ø§Ù„ØªØ³Ù„ÙŠÙ…</span>
              {% elif move.status == 'cancelled' %}
                <span class="badge bg-danger">Ø£ÙÙ„ØºÙŠØª</span>
              {% else %}
                <span class="badge bg-secondary">{{ move.get_status_display }}</span>
              {% endif %}
            </td>
            <td>{{ move.timestamp|date:"Y-m-d H:i" }}</td>
          </tr>
          {% empty %}
          <tr>
            <td colspan="5" class="text-danger text-center">Ù„Ø§ ØªÙˆØ¬Ø¯ ØªØ­Ø±ÙƒØ§Øª Ù…Ø³Ø¬Ù„Ø©.</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

  </div>
</div>
{% endblock %}
