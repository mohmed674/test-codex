{% load static %}
<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>📋 سجل الحضور</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.rtl.min.css" rel="stylesheet">
    <style>
        .status-hadir { color: green; font-weight: bold; }
        .status-absent { color: red; font-weight: bold; }
        .status-leave { color: orange; font-weight: bold; }
        @media print {
            .no-print { display: none; }
        }
    </style>
</head>
<body class="container mt-4">

    <div class="d-flex justify-content-between align-items-center mb-3">
        <h2>📋 سجل الحضور</h2>
        <a href="{% url 'attendance_create' %}" class="btn btn-success no-print">➕ تسجيل جديد</a>
    </div>

    <form method="get" class="row g-2 mb-3 no-print">
        <div class="col-md-2">
            <input type="text" name="name" placeholder="اسم الموظف" value="{{ request.GET.name }}" class="form-control">
        </div>
        <div class="col-md-2">
            <select name="status" class="form-select">
                <option value="">-- الحالة --</option>
                <option value="حاضر" {% if request.GET.status == "حاضر" %}selected{% endif %}>حاضر</option>
                <option value="غائب" {% if request.GET.status == "غائب" %}selected{% endif %}>غائب</option>
                <option value="إجازة" {% if request.GET.status == "إجازة" %}selected{% endif %}>إجازة</option>
            </select>
        </div>
        <div class="col-md-2">
            <input type="date" name="date_from" value="{{ request.GET.date_from }}" class="form-control" placeholder="من">
        </div>
        <div class="col-md-2">
            <input type="date" name="date_to" value="{{ request.GET.date_to }}" class="form-control" placeholder="إلى">
        </div>
        <div class="col-md-2">
            <button type="submit" class="btn btn-primary w-100">🔍 بحث</button>
        </div>
        <div class="col-md-2">
            <a href="{% url 'attendance_list' %}" class="btn btn-secondary w-100">🔄 إعادة تعيين</a>
        </div>
    </form>

    <table class="table table-bordered text-center align-middle">
        <thead class="table-light">
            <tr>
                <th>اسم الموظف</th>
                <th>التاريخ</th>
                <th>الحالة</th>
            </tr>
        </thead>
        <tbody>
            {% if records %}
                {% for attendance in records %}
                    <tr>
                        <td>{{ attendance.evaluation.employee.name }}</td>
                        <td>{{ attendance.date }}</td>
                        <td>
                            {% if attendance.status == "حاضر" %}
                                <span class="status-hadir">حاضر</span>
                            {% elif attendance.status == "غائب" %}
                                <span class="status-absent">غائب</span>
                            {% elif attendance.status == "إجازة" %}
                                <span class="status-leave">إجازة</span>
                            {% else %}
                                {{ attendance.status }}
                            {% endif %}
                        </td>
                    </tr>
                {% endfor %}
            {% else %}
                <tr>
                    <td colspan="3">⚠️ لا توجد نتائج مطابقة.</td>
                </tr>
            {% endif %}
        </tbody>
    </table>

</body>
</html>
