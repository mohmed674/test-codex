<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>ุณุฌูุงุช ุงูุตูุงูุฉ</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.rtl.min.css" rel="stylesheet">
</head>
<body class="bg-light p-4">

<div class="container">
    <h3 class="text-center mb-4">๐๏ธ ุณุฌูุงุช ุงูุตูุงูุฉ</h3>

    <!-- ๐ ูููุฐุฌ ุงูููุชุฑุฉ -->
    <form method="get" class="row g-3 mb-4">
        <div class="col-md-4">
            <input type="text" name="machine" placeholder="ุงุณู ุงููุงูููุฉ" value="{{ filters.machine }}" class="form-control">
        </div>
        <div class="col-md-3">
            <input type="date" name="from" class="form-control" value="{{ filters.from }}">
        </div>
        <div class="col-md-3">
            <input type="date" name="to" class="form-control" value="{{ filters.to }}">
        </div>
        <div class="col-md-2">
            <button type="submit" class="btn btn-primary w-100">๐ ุจุญุซ</button>
        </div>
    </form>

    <!-- โ๏ธ ุชูุจููุงุช -->
    {% if alerts %}
        <div class="alert alert-danger">
            <ul class="mb-0">
                {% for alert in alerts %}
                    <li>{{ alert }}</li>
                {% endfor %}
            </ul>
        </div>
    {% endif %}

    <!-- ๐ ุงูุฃุนุทุงู ุงููุชูุฑุฑุฉ -->
    {% if frequent_issues %}
        <div class="alert alert-warning">
            <strong>๐ ููุงุญุธุฉ:</strong> ูุฐู ุงููุงูููุงุช ูุฏููุง ุฃูุซุฑ ูู 3 ุฃุนุทุงู ูุณุฌูุฉ:
            <ul class="mb-0">
                {% for item in frequent_issues %}
                    <li>{{ item.machine__name }} (ุนุฏุฏ ุงูุฃุนุทุงู: {{ item.total }})</li>
                {% endfor %}
            </ul>
        </div>
    {% endif %}

    <!-- ๐๏ธ ุฌุฏูู ุงูุณุฌูุงุช -->
    <div class="table-responsive">
        <table class="table table-bordered table-striped text-center align-middle">
            <thead class="table-light">
                <tr>
                    <th>๐</th>
                    <th>ุงููุงูููุฉ</th>
                    <th>ุงูุนุทู</th>
                    <th>ุงูุฅุฌุฑุงุก</th>
                    <th>ุชุงุฑูุฎ ุงูุตูุงูุฉ</th>
                    <th>ุงูุตูุงูุฉ ุงููุงุฏูุฉ</th>
                </tr>
            </thead>
            <tbody>
                {% for log in logs %}
                    <tr>
                        <td>{{ forloop.counter }}</td>
                        <td>{{ log.machine.name }}</td>
                        <td>{{ log.issue|default:"-" }}</td>
                        <td>{{ log.action_taken|default:"-" }}</td>
                        <td>{{ log.maintenance_date|date:"Y-m-d" }}</td>
                        <td>{{ log.next_maintenance|date:"Y-m-d"|default:"-" }}</td>
                    </tr>
                {% empty %}
                    <tr><td colspan="6">ูุง ุชูุฌุฏ ุณุฌูุงุช ุญุงููุงู.</td></tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <!-- ๐ค ุฃุฏูุงุช ุงูุชุตุฏูุฑ -->
    <div class="text-center mt-4">
        <a href="{% url 'maintenance:maintenance_logs' %}?{{ request.GET.urlencode }}&download_pdf=1" class="btn btn-warning">๐ ุชุตุฏูุฑ PDF</a>
        <a href="{% url 'maintenance:maintenance_logs' %}?{{ request.GET.urlencode }}&export=1" class="btn btn-success">๐ ุชุตุฏูุฑ Excel</a>
        <a href="{% url 'maintenance:log_maintenance' %}" class="btn btn-secondary">โ ุชุณุฌูู ุตูุงูุฉ ุฌุฏูุฏุฉ</a>
    </div>
</div>

</body>
</html>
